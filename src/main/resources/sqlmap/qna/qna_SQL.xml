<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper  namespace="kr.or.ddit.mapper.QnaMapper">

<!--	<resultMap id="qnaMap" type="qna">-->
<!--		<result property="" column=""/>-->
<!--		<result property="" column=""/>-->
<!--		<result property="" column=""/>-->
<!--		<result property="" column=""/>-->
<!--		<result property="" column=""/>-->
<!--		<collection property="" resultMap=""/>-->

<!--	</resultMap>-->

	<select id="showList" resultType="qna" >
		SELECT q.QNA_CD,
		       q.MEM_NO,
		       q.QNA_TTL,
		       q.QNA_CON,
		       q.QNA_DT,
		       q.QNA_YN,
		       q.QNA_UPDATE,
		       q.QNA_HIT,
		       (select nvl(count(r.qna_cd),0) from qna_reply r where r.qna_cd = q.qna_cd) qna_reply_count
		 FROM qna q
	</select>

	<insert id="qnaSave" parameterType="qna">
		INSERT INTO qna (
              qna_cd
            , mem_no
            , qna_ttl
            , qna_con
			, qna_dt
            , qna_yn
		)
		VALUES (
			  QNA_SEQ.NEXTVAL
			, #{memNo}
			, #{qnaTtl}
			, #{qnaCon}
			, sysdate
		    , #{qnaYn}
			   )
	</insert>

	<insert id="qnaReplySave" parameterType="qnaReply">
		INSERT INTO QNA_REPLY VALUES ( #{qnaCd}, #{qnarCon}, SYSDATE)
	</insert>


	<update id="update" parameterType="qna">
		UPDATE QNA
		SET
			QNA_TTL = #{qnaTtl},
			QNA_CON = #{qnaCon},
			QNA_UPDATE = SYSDATE
		WHERE
			QNA_CD = #{qnaCd}
	</update>


</mapper>